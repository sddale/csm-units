\hypertarget{os_8h_source}{}\doxysection{os.\+h}
\label{os_8h_source}\index{csm-\/units/fmt/include/fmt/os.h@{csm-\/units/fmt/include/fmt/os.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Formatting\ library\ for\ C++\ -\/\ optional\ OS-\/specific\ functionality}}
\DoxyCodeLine{00002\ \textcolor{comment}{//}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ Copyright\ (c)\ 2012\ -\/\ present,\ Victor\ Zverovich}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ All\ rights\ reserved.}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ For\ the\ license\ information\ refer\ to\ format.h.}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#ifndef\ FMT\_OS\_H\_}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ FMT\_OS\_H\_}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <cerrno>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <cstddef>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <cstdio>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <system\_error>}\ \ \textcolor{comment}{//\ std::system\_error}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#if\ defined\ \_\_APPLE\_\_\ ||\ defined(\_\_FreeBSD\_\_)}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#\ \ include\ <xlocale.h>}\ \ \textcolor{comment}{//\ for\ LC\_NUMERIC\_MASK\ on\ OS\ X}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}format.h"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#ifndef\ FMT\_USE\_FCNTL}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ UWP\ doesn't\ provide\ \_pipe.}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#\ \ if\ FMT\_HAS\_INCLUDE("{}winapifamily.h"{}})}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#\ \ \ \ include\ <winapifamily.h>}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#\ \ if\ (FMT\_HAS\_INCLUDE(<fcntl.h>)\ ||\ defined(\_\_APPLE\_\_)\ ||\ \(\backslash\)}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\ \ \ \ \ \ \ defined(\_\_linux\_\_))\ \&\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\ \ \ \ \ \ (!defined(WINAPI\_FAMILY)\ ||\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\ \ \ \ \ \ \ (WINAPI\_FAMILY\ ==\ WINAPI\_FAMILY\_DESKTOP\_APP))}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#\ \ \ \ include\ <fcntl.h>}\ \ \textcolor{comment}{//\ for\ O\_RDONLY}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_USE\_FCNTL\ 1}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#\ \ else}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_USE\_FCNTL\ 0}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#ifndef\ FMT\_POSIX}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#\ \ if\ defined(\_WIN32)\ \&\&\ !defined(\_\_MINGW32\_\_)}}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ Fix\ warnings\ about\ deprecated\ symbols.}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_POSIX(call)\ \_\#\#call}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#\ \ else}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_POSIX(call)\ call}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{comment}{//\ Calls\ to\ system\ functions\ are\ wrapped\ in\ FMT\_SYSTEM\ for\ testability.}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#ifdef\ FMT\_SYSTEM}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#\ \ define\ FMT\_POSIX\_CALL(call)\ FMT\_SYSTEM(call)}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#\ \ define\ FMT\_SYSTEM(call)\ ::call}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#\ \ ifdef\ \_WIN32}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ Fix\ warnings\ about\ deprecated\ symbols.}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_POSIX\_CALL(call)\ ::\_\#\#call}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#\ \ else}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#\ \ \ \ define\ FMT\_POSIX\_CALL(call)\ ::call}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{comment}{//\ Retries\ the\ expression\ while\ it\ evaluates\ to\ error\_result\ and\ errno}}
\DoxyCodeLine{00061\ \textcolor{comment}{//\ equals\ to\ EINTR.}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#ifndef\ \_WIN32}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#\ \ define\ FMT\_RETRY\_VAL(result,\ expression,\ error\_result)\ \(\backslash\)}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\ \ \ \ do\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\ \ \ \ \ \ (result)\ =\ (expression);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\ \ \ \ \}\ while\ ((result)\ ==\ (error\_result)\ \&\&\ errno\ ==\ EINTR)}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#\ \ define\ FMT\_RETRY\_VAL(result,\ expression,\ error\_result)\ result\ =\ (expression)}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ FMT\_RETRY(result,\ expression)\ FMT\_RETRY\_VAL(result,\ expression,\ -\/1)}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ FMT\_BEGIN\_NAMESPACE}
\DoxyCodeLine{00074\ FMT\_BEGIN\_EXPORT}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00101\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Char>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classbasic__cstring__view}{basic\_cstring\_view}}\ \{}
\DoxyCodeLine{00102\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{const}\ Char*\ data\_;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{classbasic__cstring__view_ab464b2378652892cec4716d3e3d475c7}{basic\_cstring\_view}}(\textcolor{keyword}{const}\ Char*\ s)\ :\ data\_(s)\ \{\}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00114\ \ \ \mbox{\hyperlink{classbasic__cstring__view_a10b92cc0e3e67789601984099b9ed339}{basic\_cstring\_view}}(\textcolor{keyword}{const}\ std::basic\_string<Char>\&\ s)\ :\ data\_(s.\mbox{\hyperlink{classbasic__cstring__view_ae2cd254a4686dd81753751193af179a8}{c\_str}}())\ \{\}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00117\ \ \ \textcolor{keyword}{const}\ Char*\ \mbox{\hyperlink{classbasic__cstring__view_ae2cd254a4686dd81753751193af179a8}{c\_str}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ data\_;\ \}}
\DoxyCodeLine{00118\ \};}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ =\ \mbox{\hyperlink{classbasic__cstring__view}{basic\_cstring\_view<char>}};}
\DoxyCodeLine{00121\ \textcolor{keyword}{using\ }\mbox{\hyperlink{classbasic__cstring__view}{wcstring\_view}}\ =\ \mbox{\hyperlink{classbasic__cstring__view}{basic\_cstring\_view<wchar\_t>}};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00124\ FMT\_API\ \textcolor{keyword}{const}\ std::error\_category\&\ system\_category()\ noexcept;}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ FMT\_BEGIN\_DETAIL\_NAMESPACE}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ A\ converter\ from\ UTF-\/16\ to\ UTF-\/8.}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\ It\ is\ only\ provided\ for\ Windows\ since\ other\ systems\ support\ UTF-\/8\ natively.}}
\DoxyCodeLine{00129\ class\ utf16\_to\_utf8\ \{}
\DoxyCodeLine{00130\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{classbasic__memory__buffer}{memory\_buffer}}\ buffer\_;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00134\ \ \ utf16\_to\_utf8()\ \{\}}
\DoxyCodeLine{00135\ \ \ FMT\_API\ \textcolor{keyword}{explicit}\ utf16\_to\_utf8(\mbox{\hyperlink{classbasic__string__view}{basic\_string\_view<wchar\_t>}}\ s);}
\DoxyCodeLine{00136\ \ \ \textcolor{keyword}{operator}\ \mbox{\hyperlink{classbasic__string__view}{string\_view}}()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classbasic__string__view}{string\_view}}(\&buffer\_[0],\ size());\ \}}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{size\_t}\ size()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ buffer\_.\mbox{\hyperlink{classdetail_1_1buffer_a8685285932360c284d19003fc4ba3edc}{size}}()\ -\/\ 1;\ \}}
\DoxyCodeLine{00138\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ c\_str()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \&buffer\_[0];\ \}}
\DoxyCodeLine{00139\ \ \ std::string\ str()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ std::string(\&buffer\_[0],\ size());\ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{comment}{//\ Performs\ conversion\ returning\ a\ system\ error\ code\ instead\ of}}
\DoxyCodeLine{00142\ \ \ \textcolor{comment}{//\ throwing\ exception\ on\ conversion\ error.\ This\ method\ may\ still\ throw}}
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ in\ case\ of\ memory\ allocation\ error.}}
\DoxyCodeLine{00144\ \ \ FMT\_API\ \textcolor{keywordtype}{int}\ convert(\mbox{\hyperlink{classbasic__string__view}{basic\_string\_view<wchar\_t>}}\ s);}
\DoxyCodeLine{00145\ \};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ FMT\_API\ \textcolor{keywordtype}{void}\ format\_windows\_error(buffer<char>\&\ out,\ \textcolor{keywordtype}{int}\ error\_code,}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00149\ FMT\_END\_DETAIL\_NAMESPACE}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ FMT\_API\ std::system\_error\ vwindows\_error(\textcolor{keywordtype}{int}\ error\_code,\ \mbox{\hyperlink{classbasic__string__view}{string\_view}}\ format\_str,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classbasic__format__args}{format\_args}}\ args);}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00182\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00183\ std::system\_error\ windows\_error(\textcolor{keywordtype}{int}\ error\_code,\ \mbox{\hyperlink{classbasic__string__view}{string\_view}}\ message,}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Args\&...\ args)\ \{}
\DoxyCodeLine{00185\ \ \ \textcolor{keywordflow}{return}\ vwindows\_error(error\_code,\ message,\ fmt::make\_format\_args(args...));}
\DoxyCodeLine{00186\ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{comment}{//\ Reports\ a\ Windows\ error\ without\ throwing\ an\ exception.}}
\DoxyCodeLine{00189\ \textcolor{comment}{//\ Can\ be\ used\ to\ report\ errors\ from\ destructors.}}
\DoxyCodeLine{00190\ FMT\_API\ \textcolor{keywordtype}{void}\ report\_windows\_error(\textcolor{keywordtype}{int}\ error\_code,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00192\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ std::error\_category\&\ system\_category()\ noexcept\ \{}
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{return}\ std::system\_category();}
\DoxyCodeLine{00194\ \}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \_WIN32}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \textcolor{comment}{//\ std::system\ is\ not\ available\ on\ some\ platforms\ such\ as\ iOS\ (\#2248).}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\#ifdef\ \_\_OSX\_\_}}
\DoxyCodeLine{00199\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ S,\ \textcolor{keyword}{typename}...\ Args,\ \textcolor{keyword}{typename}\ Char\ =\ char\_t<S>>}
\DoxyCodeLine{00200\ \textcolor{keywordtype}{void}\ say(\textcolor{keyword}{const}\ S\&\ format\_str,\ Args\&\&...\ args)\ \{}
\DoxyCodeLine{00201\ \ \ std::system(format(\textcolor{stringliteral}{"{}say\ \(\backslash\)"{}\{\}\(\backslash\)"{}"{}},\ format(format\_str,\ args...)).c\_str());}
\DoxyCodeLine{00202\ \}}
\DoxyCodeLine{00203\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \textcolor{comment}{//\ A\ buffered\ file.}}
\DoxyCodeLine{00206\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classbuffered__file}{buffered\_file}}\ \{}
\DoxyCodeLine{00207\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00208\ \ \ FILE*\ file\_;}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }file;}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}(FILE*\ f)\ :\ file\_(f)\ \{\}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00215\ \ \ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordtype}{void}\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \textcolor{comment}{//\ Constructs\ a\ buffered\_file\ object\ which\ doesn't\ represent\ any\ file.}}
\DoxyCodeLine{00219\ \ \ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}()\ noexcept\ :\ file\_(\textcolor{keyword}{nullptr})\ \{\}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \textcolor{comment}{//\ Destroys\ the\ object\ closing\ the\ file\ it\ represents\ if\ any.}}
\DoxyCodeLine{00222\ \ \ FMT\_API\ \mbox{\hyperlink{classbuffered__file}{\string~buffered\_file}}()\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00225\ \ \ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}(\mbox{\hyperlink{classbuffered__file}{buffered\_file}}\&\&\ other)\ noexcept\ :\ file\_(other.file\_)\ \{}
\DoxyCodeLine{00226\ \ \ \ \ other.file\_\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00227\ \ \ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}\&\ operator=(\mbox{\hyperlink{classbuffered__file}{buffered\_file}}\&\&\ other)\ \{}
\DoxyCodeLine{00230\ \ \ \ \ close();}
\DoxyCodeLine{00231\ \ \ \ \ file\_\ =\ other.file\_;}
\DoxyCodeLine{00232\ \ \ \ \ other.file\_\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00234\ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{comment}{//\ Opens\ a\ file.}}
\DoxyCodeLine{00237\ \ \ FMT\_API\ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ filename,\ \mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ mode);}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{comment}{//\ Closes\ the\ file.}}
\DoxyCodeLine{00240\ \ \ FMT\_API\ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \textcolor{comment}{//\ Returns\ the\ pointer\ to\ a\ FILE\ object\ representing\ this\ file.}}
\DoxyCodeLine{00243\ \ \ FILE*\ get()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{\ \textcolor{keywordflow}{return}\ file\_;\ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ FMT\_API\ \textcolor{keywordtype}{int}\ descriptor()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \textcolor{keywordtype}{void}\ vprint(\mbox{\hyperlink{classbasic__string__view}{string\_view}}\ format\_str,\ \mbox{\hyperlink{classbasic__format__args}{format\_args}}\ args)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ fmt::vprint(file\_,\ format\_str,\ args);}
\DoxyCodeLine{00249\ \ \ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{00252\ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ print(\mbox{\hyperlink{classbasic__string__view}{string\_view}}\ format\_str,\ \textcolor{keyword}{const}\ Args\&...\ args)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ vprint(format\_str,\ fmt::make\_format\_args(args...));}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ \};}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \textcolor{preprocessor}{\#if\ FMT\_USE\_FCNTL}}
\DoxyCodeLine{00258\ \textcolor{comment}{//\ A\ file.\ Closed\ file\ is\ represented\ by\ a\ file\ object\ with\ descriptor\ -\/1.}}
\DoxyCodeLine{00259\ \textcolor{comment}{//\ Methods\ that\ are\ not\ declared\ with\ noexcept\ may\ throw}}
\DoxyCodeLine{00260\ \textcolor{comment}{//\ fmt::system\_error\ in\ case\ of\ failure.\ Note\ that\ some\ errors\ such\ as}}
\DoxyCodeLine{00261\ \textcolor{comment}{//\ closing\ the\ file\ multiple\ times\ will\ cause\ a\ crash\ on\ Windows\ rather}}
\DoxyCodeLine{00262\ \textcolor{comment}{//\ than\ an\ exception.\ You\ can\ get\ standard\ behavior\ by\ overriding\ the}}
\DoxyCodeLine{00263\ \textcolor{comment}{//\ invalid\ parameter\ handler\ with\ \_set\_invalid\_parameter\_handler.}}
\DoxyCodeLine{00264\ \textcolor{keyword}{class\ }FMT\_API\ file\ \{}
\DoxyCodeLine{00265\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordtype}{int}\ fd\_;\ \ \textcolor{comment}{//\ File\ descriptor.}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \textcolor{comment}{//\ Constructs\ a\ file\ object\ with\ a\ given\ descriptor.}}
\DoxyCodeLine{00269\ \ \ \textcolor{keyword}{explicit}\ file(\textcolor{keywordtype}{int}\ fd)\ :\ fd\_(fd)\ \{\}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00272\ \ \ \textcolor{comment}{//\ Possible\ values\ for\ the\ oflag\ argument\ to\ the\ constructor.}}
\DoxyCodeLine{00273\ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00274\ \ \ \ \ RDONLY\ =\ FMT\_POSIX(O\_RDONLY),\ \ \textcolor{comment}{//\ Open\ for\ reading\ only.}}
\DoxyCodeLine{00275\ \ \ \ \ WRONLY\ =\ FMT\_POSIX(O\_WRONLY),\ \ \textcolor{comment}{//\ Open\ for\ writing\ only.}}
\DoxyCodeLine{00276\ \ \ \ \ RDWR\ =\ FMT\_POSIX(O\_RDWR),\ \ \ \ \ \ \textcolor{comment}{//\ Open\ for\ reading\ and\ writing.}}
\DoxyCodeLine{00277\ \ \ \ \ CREATE\ =\ FMT\_POSIX(O\_CREAT),\ \ \ \textcolor{comment}{//\ Create\ if\ the\ file\ doesn't\ exist.}}
\DoxyCodeLine{00278\ \ \ \ \ APPEND\ =\ FMT\_POSIX(O\_APPEND),\ \ \textcolor{comment}{//\ Open\ in\ append\ mode.}}
\DoxyCodeLine{00279\ \ \ \ \ TRUNC\ =\ FMT\_POSIX(O\_TRUNC)\ \ \ \ \ \textcolor{comment}{//\ Truncate\ the\ content\ of\ the\ file.}}
\DoxyCodeLine{00280\ \ \ \};}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \textcolor{comment}{//\ Constructs\ a\ file\ object\ which\ doesn't\ represent\ any\ file.}}
\DoxyCodeLine{00283\ \ \ file()\ noexcept\ :\ fd\_(-\/1)\ \{\}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \textcolor{comment}{//\ Opens\ a\ file\ and\ constructs\ a\ file\ object\ representing\ this\ file.}}
\DoxyCodeLine{00286\ \ \ file(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ path,\ \textcolor{keywordtype}{int}\ oflag);}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00289\ \ \ file(\textcolor{keyword}{const}\ file\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00290\ \ \ \textcolor{keywordtype}{void}\ operator=(\textcolor{keyword}{const}\ file\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ file(file\&\&\ other)\ noexcept\ :\ fd\_(other.fd\_)\ \{\ other.fd\_\ =\ -\/1;\ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \textcolor{comment}{//\ Move\ assignment\ is\ not\ noexcept\ because\ close\ may\ throw.}}
\DoxyCodeLine{00295\ \ \ file\&\ operator=(file\&\&\ other)\ \{}
\DoxyCodeLine{00296\ \ \ \ \ close();}
\DoxyCodeLine{00297\ \ \ \ \ fd\_\ =\ other.fd\_;}
\DoxyCodeLine{00298\ \ \ \ \ other.fd\_\ =\ -\/1;}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00300\ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \textcolor{comment}{//\ Destroys\ the\ object\ closing\ the\ file\ it\ represents\ if\ any.}}
\DoxyCodeLine{00303\ \ \ \string~file()\ noexcept;}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \textcolor{comment}{//\ Returns\ the\ file\ descriptor.}}
\DoxyCodeLine{00306\ \ \ \textcolor{keywordtype}{int}\ descriptor()\ const\ noexcept\ \{\ \textcolor{keywordflow}{return}\ fd\_;\ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ Closes\ the\ file.}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{comment}{//\ Returns\ the\ file\ size.\ The\ size\ has\ signed\ type\ for\ consistency\ with}}
\DoxyCodeLine{00312\ \ \ \textcolor{comment}{//\ stat::st\_size.}}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ size()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{comment}{//\ Attempts\ to\ read\ count\ bytes\ from\ the\ file\ into\ the\ specified\ buffer.}}
\DoxyCodeLine{00316\ \ \ \textcolor{keywordtype}{size\_t}\ read(\textcolor{keywordtype}{void}*\ buffer,\ \textcolor{keywordtype}{size\_t}\ count);}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \textcolor{comment}{//\ Attempts\ to\ write\ count\ bytes\ from\ the\ specified\ buffer\ to\ the\ file.}}
\DoxyCodeLine{00319\ \ \ \textcolor{keywordtype}{size\_t}\ write(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ buffer,\ \textcolor{keywordtype}{size\_t}\ count);}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{comment}{//\ Duplicates\ a\ file\ descriptor\ with\ the\ dup\ function\ and\ returns}}
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//\ the\ duplicate\ as\ a\ file\ object.}}
\DoxyCodeLine{00323\ \ \ \textcolor{keyword}{static}\ file\ dup(\textcolor{keywordtype}{int}\ fd);}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{comment}{//\ Makes\ fd\ be\ the\ copy\ of\ this\ file\ descriptor,\ closing\ fd\ first\ if}}
\DoxyCodeLine{00326\ \ \ \textcolor{comment}{//\ necessary.}}
\DoxyCodeLine{00327\ \ \ \textcolor{keywordtype}{void}\ dup2(\textcolor{keywordtype}{int}\ fd);}
\DoxyCodeLine{00328\ }
\DoxyCodeLine{00329\ \ \ \textcolor{comment}{//\ Makes\ fd\ be\ the\ copy\ of\ this\ file\ descriptor,\ closing\ fd\ first\ if}}
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ necessary.}}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordtype}{void}\ dup2(\textcolor{keywordtype}{int}\ fd,\ std::error\_code\&\ ec)\ \textcolor{keyword}{noexcept};}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \textcolor{comment}{//\ Creates\ a\ pipe\ setting\ up\ read\_end\ and\ write\_end\ file\ objects\ for\ reading}}
\DoxyCodeLine{00334\ \ \ \textcolor{comment}{//\ and\ writing\ respectively.}}
\DoxyCodeLine{00335\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ pipe(file\&\ read\_end,\ file\&\ write\_end);}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//\ Creates\ a\ buffered\_file\ object\ associated\ with\ this\ file\ and\ detaches}}
\DoxyCodeLine{00338\ \ \ \textcolor{comment}{//\ this\ file\ object\ from\ the\ file.}}
\DoxyCodeLine{00339\ \ \ \mbox{\hyperlink{classbuffered__file}{buffered\_file}}\ fdopen(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ mode);}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{preprocessor}{\#\ \ if\ defined(\_WIN32)\ \&\&\ !defined(\_\_MINGW32\_\_)}}
\DoxyCodeLine{00342\ \ \ \textcolor{comment}{//\ Opens\ a\ file\ and\ constructs\ a\ file\ object\ representing\ this\ file\ by}}
\DoxyCodeLine{00343\ \ \ \textcolor{comment}{//\ wcstring\_view\ filename.\ Windows\ only.}}
\DoxyCodeLine{00344\ \ \ \textcolor{keyword}{static}\ file\ open\_windows\_file(\mbox{\hyperlink{classbasic__cstring__view}{wcstring\_view}}\ path,\ \textcolor{keywordtype}{int}\ oflag);}
\DoxyCodeLine{00345\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00346\ \};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{comment}{//\ Returns\ the\ memory\ page\ size.}}
\DoxyCodeLine{00349\ \textcolor{keywordtype}{long}\ getpagesize();}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ FMT\_BEGIN\_DETAIL\_NAMESPACE}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{keyword}{struct\ }buffer\_size\ \{}
\DoxyCodeLine{00354\ \ \ buffer\_size()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00355\ \ \ \textcolor{keywordtype}{size\_t}\ value\ =\ 0;}
\DoxyCodeLine{00356\ \ \ buffer\_size\ operator=(\textcolor{keywordtype}{size\_t}\ val)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keyword}{auto}\ bs\ =\ buffer\_size();}
\DoxyCodeLine{00358\ \ \ \ \ bs.value\ =\ val;}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{return}\ bs;}
\DoxyCodeLine{00360\ \ \ \}}
\DoxyCodeLine{00361\ \};}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \textcolor{keyword}{struct\ }ostream\_params\ \{}
\DoxyCodeLine{00364\ \ \ \textcolor{keywordtype}{int}\ oflag\ =\ file::WRONLY\ |\ file::CREATE\ |\ file::TRUNC;}
\DoxyCodeLine{00365\ \ \ \textcolor{keywordtype}{size\_t}\ buffer\_size\ =\ BUFSIZ\ >\ 32768\ ?\ BUFSIZ\ :\ 32768;}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ ostream\_params()\ \{\}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ T>}
\DoxyCodeLine{00370\ \ \ ostream\_params(T...\ params,\ \textcolor{keywordtype}{int}\ new\_oflag)\ :\ ostream\_params(params...)\ \{}
\DoxyCodeLine{00371\ \ \ \ \ oflag\ =\ new\_oflag;}
\DoxyCodeLine{00372\ \ \ \}}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ T>}
\DoxyCodeLine{00375\ \ \ ostream\_params(T...\ params,\ detail::buffer\_size\ bs)}
\DoxyCodeLine{00376\ \ \ \ \ \ \ :\ ostream\_params(params...)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ this-\/>buffer\_size\ =\ bs.value;}
\DoxyCodeLine{00378\ \ \ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{comment}{//\ Intel\ has\ a\ bug\ that\ results\ in\ failure\ to\ deduce\ a\ constructor}}
\DoxyCodeLine{00381\ \textcolor{comment}{//\ for\ empty\ parameter\ packs.}}
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#\ \ if\ defined(\_\_INTEL\_COMPILER)\ \&\&\ \_\_INTEL\_COMPILER\ <\ 2000}}
\DoxyCodeLine{00383\ \ \ ostream\_params(\textcolor{keywordtype}{int}\ new\_oflag)\ :\ oflag(new\_oflag)\ \{\}}
\DoxyCodeLine{00384\ \ \ ostream\_params(detail::buffer\_size\ bs)\ :\ buffer\_size(bs.value)\ \{\}}
\DoxyCodeLine{00385\ \textcolor{preprocessor}{\#\ \ endif}}
\DoxyCodeLine{00386\ \};}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \textcolor{keyword}{class\ }file\_buffer\ final\ :\ \textcolor{keyword}{public}\ buffer<char>\ \{}
\DoxyCodeLine{00389\ \ \ file\ file\_;}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ FMT\_API\ \textcolor{keywordtype}{void}\ grow(\textcolor{keywordtype}{size\_t})\ \textcolor{keyword}{override};}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00394\ \ \ FMT\_API\ file\_buffer(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ path,\ \textcolor{keyword}{const}\ ostream\_params\&\ params);}
\DoxyCodeLine{00395\ \ \ FMT\_API\ file\_buffer(file\_buffer\&\&\ other);}
\DoxyCodeLine{00396\ \ \ FMT\_API\ \string~file\_buffer();}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{keywordtype}{void}\ flush()\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keywordflow}{if}\ (size()\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00400\ \ \ \ \ file\_.write(\mbox{\hyperlink{structdata}{data}}(),\ size()\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structdata}{data}}()[0]));}
\DoxyCodeLine{00401\ \ \ \ \ clear();}
\DoxyCodeLine{00402\ \ \ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \textcolor{keywordtype}{void}\ close()\ \{}
\DoxyCodeLine{00405\ \ \ \ \ flush();}
\DoxyCodeLine{00406\ \ \ \ \ file\_.close();}
\DoxyCodeLine{00407\ \ \ \}}
\DoxyCodeLine{00408\ \};}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ FMT\_END\_DETAIL\_NAMESPACE}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \textcolor{comment}{//\ Added\ \{\}\ below\ to\ work\ around\ default\ constructor\ error\ known\ to}}
\DoxyCodeLine{00413\ \textcolor{comment}{//\ occur\ in\ Xcode\ versions\ 7.2.1\ and\ 8.2.1.}}
\DoxyCodeLine{00414\ \textcolor{keyword}{constexpr}\ detail::buffer\_size\ buffer\_size\{\};}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00417\ \textcolor{keyword}{class\ }FMT\_API\ ostream\ \{}
\DoxyCodeLine{00418\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00419\ \ \ FMT\_MSC\_WARNING(suppress\ :\ 4251)}
\DoxyCodeLine{00420\ \ \ detail::file\_buffer\ buffer\_;}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ ostream(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ path,\ \textcolor{keyword}{const}\ detail::ostream\_params\&\ params)}
\DoxyCodeLine{00423\ \ \ \ \ \ \ :\ buffer\_(path,\ params)\ \{\}}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00426\ \ \ ostream(ostream\&\&\ other)\ :\ buffer\_(std::move(other.buffer\_))\ \{\}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \string~ostream();}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{keywordtype}{void}\ flush()\ \{\ buffer\_.flush();\ \}}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ T>}
\DoxyCodeLine{00433\ \ \ \textcolor{keyword}{friend}\ ostream\ output\_file(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ path,\ T...\ params);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{keywordtype}{void}\ close()\ \{\ buffer\_.close();\ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00441\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ T>\ \textcolor{keywordtype}{void}\ print(\mbox{\hyperlink{classbasic__format__string}{format\_string<T...>}}\ fmt,\ T\&\&...\ args)\ \{}
\DoxyCodeLine{00442\ \ \ \ \ vformat\_to(detail::buffer\_appender<char>(buffer\_),\ fmt,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fmt::make\_format\_args(args...));}
\DoxyCodeLine{00444\ \ \ \}}
\DoxyCodeLine{00445\ \};}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00462\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ T>}
\DoxyCodeLine{00463\ \textcolor{keyword}{inline}\ ostream\ output\_file(\mbox{\hyperlink{classbasic__cstring__view}{cstring\_view}}\ path,\ T...\ params)\ \{}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{return}\ \{path,\ detail::ostream\_params(params...)\};}
\DoxyCodeLine{00465\ \}}
\DoxyCodeLine{00466\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ FMT\_USE\_FCNTL}}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ FMT\_END\_EXPORT}
\DoxyCodeLine{00469\ FMT\_END\_NAMESPACE}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ FMT\_OS\_H\_}}

\end{DoxyCode}
